<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--This is an SEO Change-->
    <title>Personal Budget Management App | Track Expenses, Reach Goals, Stay Debt-Free</title>
    <link rel="stylesheet" href="reset.css">
    <link rel="stylesheet" href="main.css">
    <!--This is an SEO Change-->
    <meta name="description" content="Take control of your finances with this personal budget management app! Track spending, set goals, automate savings, and gain insights to make smarter financial decisions. Start your journey to financial freedom today.">
    <!--This is an SEO Change-->
    <meta name="author" content="Sahand Namvar">
</head>
<body>

    <!--This is a Semantic HTML Change--> <!--&&--> <!--This is a Semantic A11y Change-->
    <!--Nav bar-->
    <nav class="menu" role="navigation">
        <ul>
            <li><a href="index.html">Homepage</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="login.html">Login</a></li>
            <!--This is a Semantic A11y Change-->
            <li><a role="link" href="https://google.com">Google</a></li>
        </ul>
    </nav>

    <!--This is a Semantic HTML Change-->
    <!--Header-->
    <header class="hero">
        <h1>Personal Budget</h1>
        <h2>A Personal Budget Management App - Made by Sahand Namvar</h2>
    </header>

    <!--This is a Semantic HTML Change-->
    <!--Main-->
    <main class="container center">

        <!--This is a Semantic HTML Change-->
        <!--Section-->
        <section class="page-area">

            <!--This is a Semantic HTML Change--> <!--&&--> <!--This is a Semantic A11y Change-->
            <!--Article-->
            <article class="text-box">
                <h1>Income and Expenses</h1>
                <p>
                    Understand your sources of income and categorize your expenses. This includes fixed costs like rent or mortgage payments, utilities, and groceries, as well as variable costs like entertainment, dining out, and discretionary spending. Having a clear picture of your financial inflows and outflows is the foundation of effective budgeting.</p>
            </article>
    
            <article class="text-box">
                <h1>Emergency Fund</h1>
                <p>
                    Building and maintaining an emergency fund is a fundamental part of personal budgeting. Aim to set aside three to six months' worth of living expenses in case of unexpected events such as job loss, medical emergencies, or unforeseen expenses. An emergency fund provides a financial safety net and helps prevent the need to rely on credit in times of crisis.</p>
                </article>
    
            <article class="text-box">
                <h1>Savings and Investments</h1>
                <p>
                    Allocate a portion of your budget to savings and investments. This can include contributions to a retirement account, a dedicated savings account for specific goals (e.g., buying a home or taking a vacation), and investments in assets such as stocks or bonds. Consistent saving and investing can lead to long-term financial stability and growth.</p>
            </article>
    
            <article class="text-box">
                <h1>Budget Tracking</h1>
                <p>
                    Regularly track your spending and compare it to your budget. Use tools, apps, or spreadsheets to monitor your financial transactions. Periodically review your budget and make adjustments as needed. Life circumstances and financial goals change, so your budget should be flexible and adaptable to reflect these changes.</p>
            </article>
    
            <article class="text-box">
                <h1>Stay on track</h1>
                <p>
                    Do you know where you are spending your money? If you really stop to track it down,
                    you would get surprised! Proper budget management depends on real data... and this
                    app will help you with that!
                </p>
            </article>
    
            <article class="text-box">
                <h1>Knowledge is Power</h1>
                <p>
                    Become a financial ninja! Many apps offer educational resources and insights, helping you understand financial concepts, make informed decisions, and avoid money traps. Learn and earn, one swipe at a time.                </p>
            </article>
    
            <article class="text-box">
                <h1>Financial Goals</h1>
                <p>
                    Define short-term and long-term financial goals as part of your budgeting process. Whether it's saving for a down payment on a house, paying off student loans, or planning for retirement, having specific and measurable goals provides motivation and direction for your budget. Adjust your budget to align with your financial priorities.</p>
            </article>

            <article class="text-box">
                <h1>Decision Making Skills</h1>
                <p>
                    Financial knowledge and decision-making skills help people make informed financial decisions through problem-solving, critical thinking, and an understanding of key financial facts and concepts. Financial knowledge and decision-making skills help people make informed financial decisions through problem-solving, critical thinking, and an understanding of key financial facts and concepts.
                </p>
            </article>
            
            <!--Pie Chart from ChartJS-->
            <article class="graph-box">
                <h1 class="center">Budget Chart</h1>
                <p><canvas id="myChart" width="400" height="400"></canvas></p>
            </article>

            <!-- Donut Chart from D3JS -->
            <article class="graph-box">
                <h1 class="center">Budget Donut Chart</h1>
                <div id="donutChart"></div>
                <div><text id="center-text"></text></div>
            </article>
        </section>

    </main>

    <!--This is a Semantic HTML Change-->
    <!--Footer-->
    <footer class="bottom">
        <div class="center">
            <!--This is an SEO Change--> <!--&&--> <!--This is a Semantic A11y Change-->
            All rights reserved &copy; 2024 Sahand Namvar | <a role="link" title="Read our Privacy Policy" href="https://www.state.gov/privacy-policy/">Privacy Policy</a>
        </div>
    </footer>

    <!--Imported Axios Library - HTTP library that lets you consume an API service. It offers different ways of making HTTP requests such as GET, POST, PUT, and DELETE.-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.7/axios.min.js" integrity="sha512-NQfB/bDaB8kaSXF8E77JjhHG5PM6XVRxvHzkZiwl3ddWCEPBa23T76MuWSwAJdMGJnmQqM0VeY9kFszsrBEFrQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!--Imported CDN Chart.JS Library-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.bundle.js" integrity="sha512-G8JE1Xbr0egZE5gNGyUm1fF764iHVfRXshIoUWCTPAbKkkItp/6qal5YAHXrxEu4HNfPTQs6HOu3D5vCGS1j3w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script>
        var dataSource = {
            datasets: [
                {
                    data: [], // will be populated by budget object values from server.js
                    backgroundColor: [
                        '#2020d4', 
                        '#23d420',
                        '#d42020',
                        '#cbd420',
                        '#7720d4',
                        '#ce20d4',
                        '#20d49e',
                        '#20d4bf',
                        '#d42089',
                        '#d4b020' 
                    ],
                }
            ],
            labels: [] // same as above
        };

        // Function to create a new instance of the chart and pass it the data
        function createChart() {
            var ctx = document.getElementById("myChart").getContext("2d"); // Create ChartJS
            var myPieChart = new Chart(ctx, {type: 'pie', data: dataSource});

            // Create Donut Chart using D3.js
            var donutChart = d3.select("#donutChart")
                .append("svg")
                .attr("width", 400)
                .attr("height", 400)
                .append("g")
                .attr("transform", "translate(200,200)");

            var arc = d3.arc()
                .innerRadius(100)
                .outerRadius(200);

            var pie = d3.pie();

            donutChart.selectAll("path")
                .data(pie(dataSource.datasets[0].data))
                .enter()
                .append("path")
                .attr("d", arc)
                .attr("fill", function (d, i) {
                    return dataSource.datasets[0].backgroundColor[i];
                });
        }
        // Function to navigate to the Route defined in server.js (/budget) using Axios, get a response (the json object budget)
        function getBudget() { // Axios: Used for making HTTP requests.
            axios.get('http://localhost:3000/budget') // access the /budget route defined in the server.js through the axios api, get a response back, manipulate the dataSource here with the budget object value from the server.
            .then(function (res) {
                console.log("Response from axios.get()", res.data);
                for (var i = 0; i < res.data.myBudget.length; i++) {
                    // Populate the dataSource objects values by reading the json object response sent back from the server.js
                    // and assigning them to the dataSource object defined here.
                    dataSource.datasets[0].data[i] = res.data.myBudget[i].budget;
                    dataSource.labels[i] = res.data.myBudget[i].title;
                }
                createChart();
                createDonutChart();
            }).catch(function (error) {
                console.error('Error fetching budget data:', error);
            });
        }

        function createDonutChart() {
            // Update Donut Chart using D3.js
            var donutChart = d3.select("#donutChart");

            var arc = d3.arc()
                .innerRadius(100)
                .outerRadius(200);

            var pie = d3.pie();

            var paths = donutChart.selectAll("path")
                .data(pie(dataSource.datasets[0].data))
                .join("path")
                .attr("d", arc)
                .attr("fill", function (d, i) {
                    return dataSource.datasets[0].backgroundColor[i];
                });
            
            /*    
            // Add text labels for each data point
            donutChart.selectAll("text")
                .data(pie(dataSource.datasets[0].data))
                .join("text")
                .text(function (d, i) {
                    console.log(dataSource.labels[i], ":", dataSource.datasets[0].data[i]); // print all data
                    return dataSource.labels[i] + ":" + dataSource.datasets[0].data[i] + " ";
                });
            */    

            // Add a central text element to display additional information
            donutChart.selectAll("#center-text").data([0]).enter()
                .append("text")
                .attr("id", "center-text")
                .text(" Hover over slices ");   
                
            // Handle mouseover and mouseout events for interactivity
            paths.on("mouseover", function (event, d, i) {
                console.log("Mouseover - d:", d); // index of the corresponding object
                d3.select(this)
                    .transition()
                    .duration(300)
                    .attr("d", d3.arc().innerRadius(95).outerRadius(190))
                    .style("opacity", 0.8);

            // Update central text with detailed information
                donutChart.select("#center-text")
                    .text(dataSource.labels[d] + ": $" + dataSource.datasets[0].data[d])
                    .style("color", dataSource.datasets[0].backgroundColor[d]);
                console.log(dataSource.labels[d] + ":" + dataSource.datasets[0].data[d]);
            }).on("mouseout", function () {
                d3.select(this)
                    .transition()
                    .duration(200)
                    .attr("d", arc) // Revert to the original arc
                    .style("opacity", 1.0)
                // Clear the central text
                donutChart.select("#center-text").text(" Hover over slices ").style("color", "#852dbf");
            });        
    
        }

        getBudget();
    </script>
</body>
</html>